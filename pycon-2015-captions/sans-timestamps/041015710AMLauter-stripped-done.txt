>> HELLO, EVERYBODY.
I HOPE YOU ENJOYED KATHERINE'S TALK AND WE'RE
MOVING ON TO MIRIAM LAUTER'S TALK ON MAKING YOUR
OWN AIR CONDITIONER.
THERE WILL BE A MODERATED Q AND A AT THE END SO
SAVE YOUR QUESTIONS AND THE MICROPHONE IS DEAD
CENTER.
OKAY.
THANK YOU.
[ Applause ]
YOU WON'T HAVE TO MAKE THE WHOLE AIR CONDITIONER
YOURSELF.
THIS IS A VERY BIG ROOM.
PEOPLE IN THE BACK, I HAVE TO PRETEND YOU'RE NOT
HERE SO I DON'T PASS OUT.
I KNOW YOU'RE ALL HERE BECAUSE IT'S MANAGED TO BE
A BALMY FEW DEGREES ABOVE FREEZING HERE IN MONDAY
TEMPORARILY AND YOU WANTED TO TALK ABOUT AIR
CONDITIONING.
BUT IF YOU CAN THINK BACK TO WHAT IT'S LIKE OVER
THE SUMMER, I LIVE IN NEW YORK, IT GETS PRETTY
MUGGY AND I WOULD COME HOME TO MY ROOM AND I
WOULD MAKE A BEELINE FOR THE AIR CONDITIONER AND
STAND THERE TRYING NOT TO TOUCH ANYTHING, AND
FINALLY THE ROOM WOULD COOL DOWN AND I WOULD GO
TO BED AND THEN I WOULD WAKE UP IN THE MIDDLE OF
THE NIGHT FREEZING, AND I STARTED TO THINK TO
MYSELF, MAN, WOULDN'T IT BE GREAT IF THERE WAS
SOME WAY TO HAVE YOUR AIR CONDITIONER SORT OF
CONTROL THE TEMPERATURE ITSELF AND MAYBE YOU
COULD EVEN TURN IT ON BEFORE YOU GOT HOME, AND
THEN I THOUGHT, SOMEONE HAS ALREADY MADE THAT.
THAT'S ALREADY A THING.
BUT, I DECIDED TO MAKE IT MYSELF SO TODAY I'M
GOING TO TALK TO YOU ABOUT HOW I MADE THAT
HAPPEN.
AND I JUST WANT TO GET A SENSE HOW MANY OF YOU IN
THE ROOM HAVE DONE A PROJECT WITH RASPBERRY PI
BEFORE?
OKAY, COOL.
AND HOW MANY OF YOU HAVE WRITTEN ANY KIND OF WEB
APP BEFORE?
AWESOME.
FOR ME IT WAS A HELLO PROJECT, AND THAT'S THE WAY
I'M GOING TO APPROACH IT BUT I HOPE IT GIVES YOU
SOME INSPIRATION FOR COOL HOME SMART PROJECTS OF
YOUR OWN.
SO THE GOAL AS I SAID IS TO BE ABLE TO TURN YOUR
AIR CONDITIONER ON AND OFF WHEN YOU'RE NOT AT
HOME, BUT ALSO TO BE ABLE TO TURN IT INTO A
THERMOSTAT SO IT CAN CONTROL THE TEMPERATURE FOR
YOU.
BUT TO BE A LITTLE BIT MORE SPECIFIC, IT'S GOING
TO BE SOMETHING A LITTLE LIKE THIS.
YOU'LL HAVE A RASPBERRY PI THAT CONTROLS YOUR AIR
CONDITIONER AND THE AIR TEMPERATURE AND IT WILL
BE CHECKING IN, SAYING, HERE'S WHAT'S GOING ON,
WHAT DO I DO?
AT SOME TIME, YOU'LL TELL IT, "TURN ON."
WHEN IT CHECKS IN NEXT, IT WILL GET THAT
INSTRUCTION AND IT WILL TURN ON.
AND IN A SLIGHTLY MORE COMPLICATED WAY, YOU'LL
DO -- WANT TO SET A PARTICULAR TEMPERATURE.
SO, AGAIN, THE RASPBERRY PI WILL BE CHECKING IN,
CHECKING IN, AND EVENTUALLY YOU'LL TELL IT, BE AT
72 DEGREES OR SOMETHING LIKE THAT AND WHEN THE
AIR CONDITIONER NEXT CHECKS IN, YOUR SERVER WILL
FIGURE OUT WHAT IT SHOULD DO AND IT WILL RESPOND
ACCORDINGLY.
THERE ARE A COUPLE OF COMPONENTS, FIRST I'LL TALK
ABOUT HOW TO SETS UP THE HARDWARE TO MAKE THESE
THINGS POSSIBLE AND THEN TALK ABOUT WRITING A
SIMPLE WEB APP IN FLASK SO WE CAN COMMUNICATE
WITH THE AIR CONDITIONER.
TO GET STARTED, YOU'LL NEED SOME STUFF, SO
ASSUMING YOU ALREADY HAVE AN AIR CONDITIONER, I
ESTIMATE THE COST FOR ALL OF THESE THINGS, WHEN I
DID THE PROJECT WAS SOMEWHERE BETWEEN 80 AND
$100.
THE GREAT THING IS, ALL OF THESE PARTS ARE
REUSABLE SO WHEN IT'S WINTER AND YOU DON'T NEED
YOUR AIR CONDITIONER, YOU CAN STATE APART AND USE
EVERYTHING AGAIN.
I HIGHLY RECOMMEND ADAFRUIT.COM, PRETTY MUCH
EVERYTHING I BOUGHT AND EVERYTHING I USE ALL THE
TUTORIALS I USED CAME FROM ADAFRUIT, SO I HIGHLY
RECOMMEND IT.
YOU'LL NEED AN AIR CONDITIONER.
TO DID THE PROJECT THE WAY I DID IT, NEEDS TO BE
WINDOW UNIT AIR CONDITIONER THAT PLUGS INTO
A.C. POWER, DRAWS LESS THAN 15 AMPS, AND AS
ALWAYS, THERE IS A SMALL CHANCE THAT SOMETHING
COULD GO WRONG SO YOU KNOW, JUST BE MINDFUL OF
THAT, BUT MY AIR CONDITIONER IS STILL INTACT.
YOU NEED A RASPBERRY PI.
YOU NEED SOME OTHER COMPONENTS FOR IT, AND DON'T
WE ARE IF I'M GOING A LITTLE QUICKLY THROUGH
THIS, I WILL MAKE THE SLIDES AVAILABLE LATER AND
I ALSO WROTE A BLOG POST ABOUT GETTING STARTED
WITH RASPBERRY PI FOR THE FIRST TIME IF YOU
HAVEN'T DONE THAT, THERE WERE SOME THING THAT
WERE A BIT TRICKY FOR ME LIKE SETTING SET UP WITH
WiFi, SO CHECK IT OUT.
NEED A LITTLE BIT MORE STUFF, A POWER SWITCH OR
RELAY, WHICH I'LL TALK ABOUT, A TEMPERATURE
SENSOR, SOME WIRES, PCB PAPER, SOME TOOLS AND
WE'LL SEE WHAT WE DO WITH THOSE LATER.
AND FOR TESTING OR DEBUGGING, I HIGHLY RECOMMEND
YOU HAVE A BREAD BOARD AND SOME LEDs AND THAT'S
JUST SO THAT YOU CAN DO A SOLDER-LESS CIRCUIT,
PLUG AND PLAY, AND YOU WON'T HAVE TO HAVE ANY HOT
METAL AND HONESTLY YOU COULD DO THE WHOLE PROJECT
JUST WITH A BREAD BOARD, IT HOLDS THINGS IN
PRETTY TIGHTLY BUT THERE IS A SMALL CHANCE THAT
THINGS COULD FALL OUT.
AND A MULTI-METER IS NICE TO HAVE FOR DEBUGGING
BUT DEFINITELY NOT NECESSARY.
SO NOW THAT YOU HAVE ALL THE STUFF, I'M GOING TO
TALK ABOUT HOW TO PUT IT ALL TOGETHER IN ORDER TO
LAY THE GROUNDWORK FOR THIS APPLICATION THAT
WE'RE GOING TO BUILD.
SO THERE'S TWO THINGS THAT THE RASPBERRY PI IS
GOING TO NEED TO BE ABLE TO DO.
IT NEEDS TO BE ABLE TO TURN YOUR AIR CONDITIONER
ON AND OFF, AND IT NEEDS TO BE ABLE TO MEASURE
THE TEMPERATURE IN YOUR ROOM.
SO TO DO THAT, TWO SIMPLE CIRCUITS.
FIRST, WE'LL NEED TO MAKE THE RASPBERRY PI ABLE
TO CONTROL THE AIR CONDITIONER SO TO DO THAT,
WE'LL USE A RELAY, AN ELECTRICALLY CONTROLLED
SWITCH.
SO IT'S AS IF YOU TOOK YOUR AIR CONDITIONER'S
POWER CORD AND JUST CUT IT IN THE MIDDLE AND
BETWEEN THE PART THAT PLUGS INTO THE WALL AND THE
PART THAT PLUGS INTO YOUR AIR CONDITIONER, YOU
PUT LIKE A LIGHT SWITCH BUT INSTEAD OF
CONTROLLING IT WITH YOUR HAND, WE'RE JUST GOING
TO CONTROL IT WITH A LITTLE BIT OF POWER COMING
FROM ONE OF THE RASPBERRY PI'S OUTPUT PINS.
SO WHEN POWER FLOWS FROM THAT PIN, THE SWITCH
WILL CLOSE AND POWER CAN FLOW FROM THE WALL TO
YOUR AIR CONDITIONER AND WHEN WE SET THAT OUTPUT
PIN LOW AND NO POWER COMES FROM IT, THEN THE
SWITCH WILL OPEN AND THE AIR CONDITIONER WILL
TURN OFF, AND THE AIR CONDITIONER ITSELF WILL
ALWAYS BE IN THE ON POSITION, SO ON MINE, THAT'S
JUST THE DIAL IS TURNED TO "ON" ALL THE TIME.
AND SO THE FIRST THING YOU SHOULD DO IS CONSULT A
PIN-OUT MAP OF YOUR RASPBERRY PI AND I LOOK TO
LOOK AT ONE THAT HAS THE PICTURE OF THE RASPBERRY
PI IN THE BACKGROUNDS SO YOU CAN BE ORIENTED AND
FIND A PIN LABELED GPIO FOR GENERAL PURPOSE
INPUT/OUTPUT.
I HAPPENED TO USE A TEMPERATURE SENSOR THAT HAD
SOME CODE, THAT HARD-CODED USING GPI 4 SO I USED
THAT ONE, SO LET'S GO PICK PIC GPIO 17.
SO CONNECT BRIGHTLY COLORED WIRE TO THAT ONE AND
THEN A DARK-COLORED WIRE, JUST SO YOU KNOW WHICH
ONE HAS POWER FLOWING FROM IT, AND CONNECT THAT
TO GROUND.
AND THEN YOU'LL TAKE YOUR POWER SWITCH AND THE
RED WIRE WILL GO INTO THE PLUS-IN SPOT AND THE
BLACK WIRE GOES INTO MINUS IN, AND YOU CAN IGNORE
THE THIRD SPOT LABELED "GROUND" BECAUSE YOU'RE
ALREADY GROUNDED.
AND IT HAS SOME SCREW DRIVERS IN THE TOP -- HAS
SOME SCREWS IN THE TOP SO YOU CAN PUTS THE WIRE
IN AND SCREW IT BACK DOWN SO IT DOESN'T JUST FALL
OUT AND YOU'LL BE ABLE TO CONTROL THE AIR
CONDITIONER RELIABLY.
NOW, WHILE YOU'RE TESTING YOUR APPLICATION, ONCE
WE'VE WRITTEN IT, THERE'S REALLY NO REASON TO BE
CONNECTED TO THE POWER SWITCH OR YOUR AIR
CONDITIONER AT ALL.
IT'S KIND OF HARD TO LUG AROUND WITH YOU, YOU
MIGHT WANT TO TEST IT SOMEWHERE ELSE, AND BECAUSE
ALL WE'RE DOING IS CONTROLLING WHETHER POWER IS
FLOWING FROM THAT RASPBERRY PI OUTPUT PIN, YOU
CAN JUST CONNECT IT TO AN LED IN YOUR BRED BOARD
AND IF YOU CAN TURN YOUR LIGHT ON, YOU CAN TURN
YOUR AIR CONDITIONER ON.
SO NOW THAT WE CAN CONTROL THE AIR CONDITIONER
FROM THE RASPBERRY PI, WE ALSO NEED TO BE ABLE TO
MEASURE TEMPERATURE IN THE ROOM.
TO DO THAT, I USED A DIGITAL TEMPERATURE SENSOR
AND I WON'T GO INTO TOO MUCH DETAIL ABOUT HOW THE
CIRCUIT IS WIRED UP.
AGAIN, I BOUGHT IT FROM ADAFRUIT THEY HAD A NICE
TUTORIAL, CODE SAMPLE, REALLY EASY.
ALL YOU NEED TO KNOW IS THE YELLOW WIRE IS THE
DATA WIRE AND THAT WILL ALSO BE CONNECTED TO A
GPIO PIN BUT THIS TIME WILL BE READING FROM IT,
WILL BE COLLECTING DATA AND THAT WILL BE
CONVERTED INTO FAHRENHEIT OR CELSIUS DEGREES,
WHATEVER YOU PREFER.
AND SOMETIMES IT'S A LITTLE BIT EASIER TO SEE THE
DIAGRAM THIS WAY.
AND THEN, ONCE YOU'RE ALL SET WITH THAT, YOU CAN
SOLDER IT TOGETHER ON SOME PROTOTYPE PCB PAPER
BUT, AGAIN, YOU DEFINITELY DON'T HAVE TO, YOU CAN
LEAVE IT IN THE BREAD BOARD.
SO NOW WE HAVE ALL THE CONNECTIONS IN PLACE THAT
WILL MAKE IT POSSIBLE FOR THE AIR CONDITIONER TO
CONTROL -- FOR THE RASPBERRY PI TO CONTROL YOUR
AIR CONDITIONER AND SENSE TEMPERATURE IN THE
ROOM.
SO WE HAVE THE AIR CONDITIONER, THE RASPBERRY PI,
THE DIGITAL TEMPERATURE SENSOR AND THEY'RE ALL
CONNECTED.
NOW THAT THAT IS READY, I'M GOING TO TALK A BIT
ABOUT HOW TO WRITE A SIMPLE WEB APP IN FLASK
BECAUSE IT'S GREAT THAT WE HAVE ALL THIS HARDWARE
CONNECTED BUT IF WE CAN'T COMMUNICATE WITH IT IN
ANY WAY, IT'S KIND OF USELESS.
SO WE'RE GOING TO NEED SOMETHING HOSTED SOMEWHERE
ON THE INTERNET WHERE YOU CAN GO TO A PAGE IN
YOUR BROWSER AND YOU CAN SEND SOME INSTRUCTIONS
THAT YOU WANT YOUR AIR CONDITIONER TO FOLLOW, AND
THE RASPBERRY PI WILL ALSO NEED TO BE ABLE TO
REACH THIS PLACE, WHEREVER IT IS, AND GET SOME
INFORMATION THAT YOU'VE LEFT FOR IT AND TELL YOU
WHAT THE TEMPERATURE IS ENGINEER ROOM AND OTHER
THINGS -- IS IN YOUR ROOM AND OTHER THINGS LIKE
THAT.
AND WE'LL NEED TO BE ABLE TO STORE THAT
INFORMATION IN BETWEEN, SO THE RASPBERRY PI WILL
CHECK IN AND SAY, IT'S 70 DEGREES IN YOUR ROOM
AND THE AIR CONDITIONER IS ON.
WE'LL NEED TO STORE THAT SO WHEN THE USER GOES TO
THE PAGE IN THEIR BROWSER, THEY CAN SEE THAT
INFORMATION AND THEY CAN ALSO SEND SOME
INFORMATION, NEED TO STORE -- OH, THE USER SAID
THEY WANT THE AIR CONDITIONER TO BE ON SO THAT
WHEN THE RASPBERRY PI CHECKS IN, IT WILL GET THAT
INFORMATION BACK.
TO DO THIS, I USED GLASS, WHICH IS A WEB MIGHT BE
ROW FRAMEWORK FOR PYTHON.
SUPER LIGHTWEIGHT, REALLY EASY TO SET UN, CAN
WRITE A ONE-PAGE APPLICATION SO I HIGHLY
RECOMMEND IT.
SOME REALLY GREAT RESOURCES OUT THERE ON THE
INTERNET.
AND IN PARTICULAR, THE FLASK TUTORIAL, DEFINITELY
MORE INFORMATION THAN YOU EVEN NEED TO DO THIS
PROJECT BUT IT'S SUPER INTERESTING READ.
SO YOU JUST SET UPROOT DIRECTORY WITH YOUR APP.PI
FILE IN IT AND TWO SUBDIRECTORIES, ASSETS AND
TERM PLATES, ASSETS FOR ANY CSS OR -- AND TEMP
PLATES FOR HTML, AND THIS IS WHAT A SIMPLE HOLLOW
WORLD APPLICATION LOOKS LIKE IN FLASK.
AND YOU MAY RECOGNIZE THE DECORATOR SYNTAX AND IF
YOU'RE FAMILIAR WITH DECORATORS IN PYTHON, THAT'S
AWESOME.
IF YOU'RE NOT THAT FAMILIAR WITH THEM, THAT'S
ALSO TOTALLY FINE.
WHAT YOU NEED TO KNOW IS THIS SAYS, ADD THE
FOLLOWING RULE.
WHEN WE GET A REQUEST FROM A URL LIKE SLASH, IN
THIS CASE, WWW.MYSITE.COM SLASH, THEN RUN THE
FOLLOWING FUNNELS, RUN THE HELLO FUNCTION HIM AND
THAT FUNCTION IS GOING TO GO FIND THE TEMPLATE
CALLED INDEX POTT HTML, WILL PASS IN WHATEVER
VARIABLES WE'VE GIVEN IT AND FLASK COMES WITH A
TEMPLATING ENGINE CALLED GINGA, SO IT WILL POP
THAT DATA INTO THE TEMPLATE AND THEN DISPLAY --
OH, I GUESS THAT'S A LITTLE OFF THE SCREEN.
OH, I GUESS IT'S STILL OFF THE SCREEN.
IT WILL DISPLAY SOMETHING LIKE HELD LOW, WORLD
AND HELLO, MIRIAM.
IF YOU RUN IT IN DEBUG MODE, YOU'LL GET A NICE
STACK TRACE ON THE PAGE WHICH IS CONVENIENT.
WITH THAT HELLO WORLD APPLICATION, WE ONLY HAD
ONE END POINT, THE HELLO ROUTE, AND FOR THIS
APPLICATION, WE'LL ACTUALLY NEED THREE END
POINTS, SO, FIRST, WE HAVE THE HOME PAGE, AND FOR
THAT, WE'LL JUST GET SOME INFORMATION THAT THE
SERVER HAS STORED ABOUT WHAT'S GOING ON IN THE
ROOM AND DISPLAY THE FORM THAT YOU WOULD USE TO
SEND SOME INFORMATION TO YOUR SERVER ABOUT WHAT
YOU WANT THE AIR CONDITIONER TO DO.
AND THEN WE'LL NEED TO WRITE THE END POINT TO
ACTUALLY DO THAT, TO ALLOW YOU TO SUBMIT THAT
FORM WITH YOUR INSTRUCTIONS, AND WE'LL NEED A
ROOT FOR THE RASPBERRY PI TO CHECK IN, GIVE THE
SERVER INFORMATION ABOUT WHAT'S GOING ON IN THE
ROOM AND GET INSTRUCTIONS BACK.
SO THE FIRST END POINT FOR THE HOME PAGE LOOKS
VERY MUCH LIKE THE HELLO WORLD EXAMPLE.
AND YOU CAN SEE, YOU CAN ADD AS MANY ROOT
DECORATORS AS YOU WANT SO IN THIS CASE BOTH SLASH
AND INDEX WILL GIVE YOU THE HOME PAGE.
AND THE ONLY DIFFERENCE IS WE'LL NEED TO GET DATA
THAT HAS BEEN STORED BY THE RASPBERRY PI TO
DISPLAY, AND YOU CAN DO THAT REALLY HOWEVER YOU
WANT.
WHEN I DID IT, I USED THE PYTHON SQL 8 LIBRARY 3,
MOSTLY I WANTED TO KEEP SOME INFORMATION ABOUT
WHAT THE TEMPERATURE WAS IN MY ROOM AND HOW MUCH
I WAS USING MY AIR CONDITIONER BUT IF YOU DON'T
WANT TO DO THAT, AND HOPEFULLY NO ONE WILL YELL
AT ME BUT YOU CAN PROBABLY JUST STORE IT IN A
GLOBAL VARIABLE AND EVERYTHING WILL BE OKAY.
AND IT WILL DISPLAY A BEAUTIFUL PAGE, SOMETHING
LIKE THAT, AND YOU'LL SEE THE MOST UP-TO-DATE
INFORMATION YOU HAVE ABOUT YOUR ROOM AND YOUR AIR
CONDITIONER AND THE FORM YOU WOULD USE TO SEND
SOME INFORMATION.
NOW, AS YOU CAN SEE, THE USER HAS SORT OF THREE
POSSIBLE THINGS THEY MIGHT WANT TO SAY TO THEIR
AIR CONDITIONER.
YOU MIGHT WANT TO SAY JUST TURN ON AND BE ON, OR
YOU MIGHT WANT TO JUST SAY TURN ON AND BE OFF OR
YOU MIGHT WANTS TO SAY, KEEP MY ROOM AT 72
DEGREES.
BUT THE THING IS, THE RASPBERRY PI REALLY ONLY
UNDERSTANDS TWO STATES.
IT CAN SETS THE SWITCH PIN HIGH AND TURN ITS ON
OR SET IT LOW AND TURN THE AIR CONDITIONER OFF SO
WE NEED A WAY TO TRANSLATE BETWEEN WHAT THE USER
WANTS THE AIR CONDITIONER TO BE DOING AND WHAT
THE RASPBERRY PI CAN ACTUALLY CARRY OUT.
SO THERE WILL BE SORT OF A MIDDLE LAYER, WE'LL GO
FROM THE THREE STATES THE USER KNOWS AND THEN
WRITE A FUNCTION TO TRANSLATE THAT INTO THE STATE
THE RASPBERRY PI UNDERSTANDS, AND ON AND OFF, TO
MAP NICELY TO ON AND OFF BUT WHEN SPECIFY A
TEMPERATURE, I'LL NEED TO CHECK WHAT IS THE
TEMPERATURE IN THE ROOM RIGHT NOW, WHAT
TEMPERATURE DID THE USER SAY THEY WANTED AND THEN
RETURN A RESPOND TO RASPBERRY PI WITH EITHER ONE
OR ZERO, ON OR OFF, ACCORDINGLY.
SO NOW WE'LL WRITE THAT END POINT FOR THE USER
AND WE'LL GET THE DATA THAT THEY SEND IN THEIR
POST REQUEST, FIND THE MOST RECENTLY TRANSLATED
TEMPERATURE, TRANSLATES THAT INTO THE DESIRED
STATE AND STORE THAT SOMEWHERE.
FINALLY, WE'LL WRITE THE ROOT FOR THE RASPBERRY
PI AND WE'LL GET THE DATA FROM THE RASPBERRY PI'S
POST-REQUEST, STORE THAT TEMPERATURE AND THE AIR
CONDITIONER STATE SOMEWHERE, AND THEN WE'LL
RESPOND TO THAT REQUEST WITH WHATEVER THE MOST
RECENTLY STORED DESIRED STATE FROM THE USER IS.
SO NOW THAT THAT APPLICATION IS UP AND RUNNING,
THE LAST PIECE OF THE PUZZLE IS IT'S ALL WELL AND
GOOD, WE COULD GO TO THIS WEBSITE, WE COULD SEND
SOME INFORMATION, SAY WE WANT THE AIR CONDITIONER
TO BE ON BUT IF THE RASPBERRY PI ISN'T CHECKING
IN WITH THE SERVER, IT'S NEVER GOING TO GET THAT
INFORMATION BECAUSE THE ONLY WAY WE'RE SENDING IT
INSTRUCTIONS IS WE'RE RESPONDING TO THE RASPBERRY
PI'S POST REQUEST.
SO RASPBERRY PI WILL NEED TO MAKE REQUESTS, SET
THE SWITCH PIN HIGH OR LOW ACCORDINGLY AND DO
THAT OVER AND OVER AND OVER AGAIN.
SO IN ORDER TO MAKE REQUESTS, I USE THE REQUEST
LIBRARY.
IT'S GREAT, SUPER EASY.
YOU PUT IN THE URL/THE ROOT -- THE ENDS POINT YOU
JUST WROTE, SEND THE DATA ABOUT THE ROOM AND THE
AIR CONDITIONER, AND THE RESPONSE WILL BE STORED
IN THIS VARIABLE "R."
AND THEN WE NEED TO BE ABLE TO SET THE SWITCH PIN
AND IN ORDER TO DO THAT, YOU NEED ANOTHER PYTHON
LIBRARY CALLED RPYTHON.GPIO.
YOU TELL IT WHICH ONE YOU'RE USING AS THE SWITCH
PIN, YOU'LL TELL IT IT'S AN OUTPUT PIN AND SET IT
FALSE TO START, AND WRITE A SIMPLE FUNCTION TO
CHECK WHETHER THAT PIN IS HIGH OR LOW.
FINALLY, WE'LL PUT IT ALL TOGETHER AND CONTROL
THE AIR CONDITIONER, MAGICALLY.
IT WILL LOOK LIKE THIS, MAKE THE REQUEST, GET THE
RESPONSE AND FIT COMES BACK WITH 1, SET THE
SWITCH PIN HIGH AND TURN THE AIR CONDITIONER ON.
COMES BACK WITH ZERO, THEN WE'LL SET THE SWITCH
PIN LOW AND TURN THE AIR CONDITIONER OFF.
NOW, THAT'S GREAT IF WE DO THAT ONCE, MAYBE GET
ONE INSTRUCTION BUT WE'LL NEED TO PUT THAT IN A
LOOP AND DO THIS OVER AND OVER AND OVER AGAIN.
AND I THINK MINE WAS GOING LIKE EVERY SECOND OR
SOMETHING LIKE THAT.
AND THAT'S ALL WELL AND GOOD AND IT WORKS FOR A
WHILE BUT WHAT HAPPENS -- OOPS.
WHAT HAPPENS IF THE SERVER DOESN'T RESPOND?
AND THAT'S GOING TO HAPPEN AT SOME POINT.
YOU'RE JUST MAKING REQUESTS OVER AND OVER AND
OVER AGAIN, AND RIGHT NOW, IF WE JUST HAVE A WILD
LOOP, IT'S GOING TO BREAK, EXIT AND WE'LL LOSE
CONTACT WITH THE RASPBERRY PI ENTIRELY.
AND THAT KIND OF WAS MY WORST-CASE SCENARIO THAT
I WOULD BE AWAY FROM HOME, TURN THE AIR
CONDITIONER ON FOR SOME REASON AND EVERYTHING
WOULD CRASH AND I WOULDN'T BE ABLE TO TURN IT OFF
AND IT WOULD BE SITTING THERE WASTING POWER.
SO JUST TO MAKE THAT A BIT MORE RESILIENT, WE CAN
PUT THAT IN A TRICATCH LOCK, TRY TO MAKE THE
REQUEST.
IF IT SUCCEEDS, KEEP GOING IN THE LOOP, WAITS A
SECOND, TRY AGAIN.
WAIT A SECOND, DO IT AGAIN.
BUT IF IT FAILS, THEN WE'LL CHECK HOW LONG HAS IT
BEEN SINCE THE LAST TIME WE GOT A SUCCESSFUL
REQUEST?
AND IF IT'S BEEN UNDER FIVE MINUTES, JUST KEEP
GOING, JUST KEEP TRYING.
IF IT'S BEEN OVER FIVE MINUTES, TURN THE AIR
CONDITIONER OFF AND THEN JUST KEEP TRYING BECAUSE
HOPEFULLY THE SERVER WILL COME BACK AT SOME POINT
OR YOU'LL FIX IT, YOU'LL GO IN AND SEE WHAT WENT
WRONG AND THAT WAY YOU DON'T HAVE TO SSH BACK
INTO YOUR RASPBERRY PI AND START THE PROGRAM
RUNNING AGAIN.
IT JUST HOPEFULLY WON'T CRASH AND WILL JUST KEEP
WAITING AND THAT WAY YOU CAN ENJOY A PERFECTLY
TEMPERATURE-CONTROLLED ROOM ALL SUMMER.
AND I JUST HAVE SOME FINAL NOTES, OR REALLY A
FINAL NOTE, WHICH IS ABOUT SECURITY.
AS WE ALL KNOW, THE INTERNET ISN'T THE SAFEST
PLACE AND BEYOND JUST LIKE SOMEONE MALICIOUS
TRYING TO EXECUTE CODE ON YOUR SERVER OR
SOMETHING COMPLICATED, IT WOULD BE PRETTY BAD IF
JUST LIKE ANY OLD PERSON COULD FIND YOUR WEBSITE
HOSTED WHEREVER ON HEROKU OR SOMETHING, AND TURN
YOUR AIR CONDITIONER ON.
SO AT MINIMUM, JUST LIKE YOU CAN USE ROUTE
DECORATORS IN FLASK TO MAP URLS TO FUNCTION, YOU
CAN USE OTHER DECORATORS, SO YOU COULD WRITE A
LOG-IN REQUIRED FUNCTION THAT CHECKS SOME
CREDENTIALS OF SOME SORT, USE A DECORATOR, WRAP
THAT AROUND YOUR VIEW FUNCTION AND THEN IF THE
CREDENTIALS AREN'T THERE, DON'T EXECUTE THE
FUNCTION, AND YOU SHOULD ALSO PROBABLY CHECK THAT
THE INPUT THAT YOU'RE GETTING IS WHAT YOU EXPECT
SO IF IT'S THE FORM IN THE BROWSER YOU EXPECT TO
BE GETTING A NUMBER AND YOU EXPECT IT TO BE A
TEMPERATURE IN SOME REASONABLE RANGE, AND IF IT'S
THE RASPBERRY PI, YOU EXPECT TO GET THE
TEMPERATURE IN THE ROOM AND JUST A BOOLEAN
ON-OFF, SO YOU SHOULD PROBABLY MAKE SURE OF THAT.
AND NOW I WILL SHOW YOU A QUICK DEMO OF MY AIR
CONDITIONER IN ACTION.
IT IS NOT THE BEST VIDEO AND IT WILL ONLY WORK IF
YOU'RE ALL VERY QUIET.
I'M JUST GOING TO DO A QUICK DEMONSTRATION HERE.
HOW I CAN TURN MY AIR CONDITIONER ON FROM MY
BROWSER, SO I'M GOING TO GO OVER TO THIS PAGE.
AND JUST REFRESH.
OKAY, SO MY AIR CONDITIONER IS OFF, IF YOU CAN
SEE THAT.
IT IS IN FACT OFF.
YOU CAN'T HEAR ANYTHING.
AND YOU WON'T SEE ANY LITTLE RED LIGHT ON THE
POWER SWITCH.
I'M DOING TO TELL IT "TURN ON," SO I CLICK THAT
RADIO BUTTON, HIT "SUBMIT" HERE.
WAITING, WAITING.
GIVE IT A SECOND.
[ SOUNDS OF AIR CONDITIONER TURNING ON]
>> DID YOU HEAR THAT?
YOU CAN SEE THE RED LIGHT.
[ Laughter ]
>> AND WE TELL IT TO TURN OFF.
[ AIR CONDITIONER TURNS OFF ]
>> ONE TAKE.
>> ONE TAKE.
>> THERE YOU GO.
[ Applause ]
THANK YOU SO MUCH, EVERYBODY.
AND I'VE JUST WANTED TO SAY A QUICK THANKS TO THE
RECURSE CENTER/HACKER SCHOOL BECAUSE I COULD NOT
HAVE DONE THIS PROJECT WITHOUT EVERYONE THERE.
SO, THANKS.
[ Applause ]
>> ALL RIGHT.
THANK YOU, MIRIAM.
IF ANYBODY HAS ANY QUESTIONS, THEN THEY CAN COME
UP TO THIS MICROPHONE AND ASK THEM.
THANK YOU.
[ AUDIENCE:  HI, THANKS FOR THE TALK.
I'M CURIOUS IF THIS PROJECT HAS MADE YOU MORE
EXCITED OR LESS EXCITED ABOUT SORT OF THE
PROMISED FUTURE OF THE INTERNET OF THINGS.
>> HUM, THAT'S A GOOD QUESTION.
SO, IT MADE ME REALLY EXCITED ABOUT DOING MORE
INTERNET OF THINGS, PROJECTS MYSELF, BECAUSE
THEY'RE REALLY FUN BUT I THINK IT KIND OF
DE-MYSTIFIED TO SOME EXTENT LIKE HOW COOL THESE
DEVICES ARE BECAUSE IT'S REALLY NOT VERY HARD TO
PUT TOGETHER YOURSELF.
SO, YEAH, I -- AND I ALSO THINK IT'S GOING TO BE
A LONG TIME BEFORE MY SMART AIR CONDITIONER CAN
DO MY LAUNDRY, SO, YOU KNOW...
>> AUDIENCE:  THANKS FOR THE TALK.
I WAS -- I ACTUALLY DID SMART THERMOSTATS FOR A
WHILE BEFORE MY COMPANY FOLDED AND I WAS KIND OF
CURIOUS, HAVE YOU LOOKED INTO GETTING INTO MAYBE
HUMIDITY SENSORS AND SEEING IF YOU COULD GET MORE
THERMAL COMFORT LEVELS SO, IF YOU GOT REALLY HIGH
HUMIDITY, YOU DON'T WANT IT TO GET REALLY COLD
EVEN IF IT'S SET TO THE SAME TEMPERATURE AS
NORMAL.
>> YEAH, THAT'S A REALLY GREAT IDEA.
I HAVEN'T TRIED TO DO THAT BUT I KNOW THERE ARE
ALL SORTS OF LIKE FUN SENSORS THAT YOU CAN GET
FOR THE RASPBERRY PI SO I'M BUILDING UP A
COLLECTION OF NEW TOYS.
>> AUDIENCE: COOL.
I LOOK FORWARD TO CHECKING THAT ONE OUT.
>> AUDIENCE: HI, MIRIAM.
DID YOU DECIDE TO CHECK IN ON THE SERVER LIKE
ONCE EVERY SECOND WITH ANY, LIKE, DATA OR DID YOU
JUST DECIDE THAT ARBITRARILY?
>> SORRY, I DIDN'T HEAR THE VERY END OF THE
QUESTION.
>> AUDIENCE:  OR DID YOU JUST DECIDE HOW OFTEN TO
CHECK THE SERVER ARBITRARILY?
>> YES, I JUST DECIDED ARBITRARILY.
SINCE I DESIGNED THIS JUST WITH MYSELF AND MY
RASPBERRY PI IN MIND, I WASN'T THINKING VERY MUCH
LIKE BLOWING UP THE SERVER WITH REQUESTS BECAUSE
IT JUST WAS ONLY ME USING IT SO I FIGURED ONCE A
SECOND WOULD DEFINITELY BE FREQUENT ENOUGH AND
WOULD BE FINE, SO IT WAS PRETTY ARBITRARY, YEAH.
>> AUDIENCE:  THANKS.
>> AUDIENCE:  DO YOU THINK YOU COULD OPEN UP THE
A.C. AND FIGURE OUT THINGS LIKE FAN SPEED OR -- I
MEAN, MORE THAN JUST ON AND OFF?
DID YOU LEARN ENOUGH TO DO MORE THAN THAT?
>> AT THE TIME THAT I WAS DOING THIS PROJECT, I
DEFINITELY WOULD HAVE NEEDED SOME HELP TO DO THAT
AND I PROBABLY STILL WOULD.
I THINK IT'S POSSIBLE BUT I SORT OF WEIGHED THE
CHANCES THAT I WOULD BREAK SOMETHING OR SET MY
ROOM ON FIRE AGAINST LIKE HOW COOL THAT WOULD BE,
SO -- BUT, YOU KNOW, MAYBE ONE DAY.
>> AUDIENCE:  HEY, THANKS FOR THE TALK.
SO I THINK THE ONLY THING WORSE THAN WAKING UP
WITHOUT MY A.C. ON WOULD BE HAVING TO GET ON MY
COMPUTER AND REBOOT A SERVER BECAUSE MY
A.C. ISN'T ON.
DID YOU THINK ABOUT ANY WAYS THAT, LIKE -- I
TOTALLY UNDERSTAND THE IDEA TO TURN THE A.C. OFF
IF IT'S NOT RESPONDING BECAUSE YOU DON'T WANT TO
JUST LEAVE THE THING ON.
ARE THERE ANY OTHER WAYS YOU COULD, LIKE, GET
AROUND THAT AND, I DON'T KNOW, MAKE IT FAIL-PROOF
BUT ALSO HIT A TARGETED TEMPERATURE OR SOMETHING
LIKE THAT?
>> YEAH, I MEAN, SO I MIGHT JUST AS A VERY SIMPLE
SOLUTION TO THAT KIND OF -- IF IT'S IN THE, LIKE,
ON-ON STATE, THEN TURN IT OFF BECAUSE IT WOULD
NEVER TURN ITSELF OFF BUT IF IT'S IN TEMPERATURE
CONTROL STATE, IT COULD PROBABLY SURVIVE ON ITS
OWN FOR A WHILE UNTIL I GET HOME BUT IN ORDER TO
DO THAT, I WOULD HAVE TO ALSO MAKE SURE TO STORE,
LIKE, WHAT THE RASPBERRY PI THINKS THE STATE IS
AND I KIND OF LEFT THAT LOGIC ON THE SERVER SO IT
WOULD DEFINITELY BE SOMETHING TO THINK ABOUT,
YEAH.
>> A LITTLE BIT OF SHAMELESS ADVERTISING, I WANT
TO SAY IF ANYBODY IS INTERESTED IN ENVIRONMENTAL
MONITORING, I HAVE THIS VERY LARGE AND EXTENSIVE
OPEN SOURCE PROJECT WRITTEN IN PEARL THAT NEEDS
TO BE IMPORTED TO PYTHON SO IF ANYBODY IS
INTERESTED, I WOULD BE DELIGHTED TO GET SOME HELP
AND IT WOULD RELATE VERY NICELY TO WHAT YOU'RE
DOING.
GREAT TALK, THANK YOU.
>> ALL RIGHT, THANKS.
>> AUDIENCE:  HEY, CAN YOU DO THE SAME THING WITH
A SPACE HEATER OR IS IT TO ELECTRICALLY TOO
DANGEROUS OR SOMETHING?
>> SPACE HEATERS ARE PRETTY DANGEROUS.
I WOULD NOT DO IT.
BUT THAT'S ME.
IF YOU LIKE TO LIVE ON THE EDGE, I TOLD YOU NOT
TO.
[ Laughter ]
ANYBODY ELSE?
ALL RIGHT, THANKS SO MUCH, YOU GUYS.
[ Applause ]
